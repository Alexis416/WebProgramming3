:root{
  --board-max-width: 520px; /* максимальная ширина поля на десктопе */
  --board-gap: 12;          /* отступы между ячейками — будут подстраиваться в JS */
  --cell-size: 100;         /* будет переопределено JS при вычислении размеров */
  --transition: 180ms;
}

* { box-sizing: border-box; }
body{
  margin:0;
  font-family: Inter, "Helvetica Neue", Arial, sans-serif;
  background: #faf8ef;
  color: #776e65;
  display:flex;
  flex-direction:column;
  align-items:center;
  min-height:100vh;
  padding:12px;
}

.header{
  width:100%;
  max-width:calc(var(--board-max-width) + 40px);
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:8px;
}
.title{
  margin:8px 0 0 0;
  font-size:28px;
  letter-spacing:1px;
}
.top-controls{
  width:100%;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
}
.score-box{
  font-weight:700;
  font-size:16px;
  background:#bbada0;
  color:#f9f6f2;
  padding:6px 10px;
  border-radius:6px;
}
.buttons button{
  margin-left:6px;
  padding:8px 10px;
  border-radius:6px;
  border:none;
  background:#8f7a66;
  color:#fff;
  cursor:pointer;
}
.buttons button:disabled{
  opacity:0.5;
  cursor:not-allowed;
}

/* центрируем поле */
.main{
  width:100%;
  max-width:calc(var(--board-max-width) + 40px);
  display:flex;
  justify-content:center;
  margin-top:12px;
}
#board-wrapper{
  width:100%;
  display:flex;
  justify-content:center;
  align-items:center;
}
#game-board{
  position:relative;
  width:100%;
  max-width:var(--board-max-width);
  background:#bbada0;
  border-radius:8px;
  padding:var(--board-gap);
  /* высота делается равной ширине — JS также использует clientWidth */
  aspect-ratio: 1/1;
  box-shadow: 0 4px 0 rgba(0,0,0,0.05);
  touch-action: none;
  overflow:visible;
}

/* фоновые клетки (фиксированные пустые ячейки) — создаются в JS once */
.cell-bg{
  position:absolute;
  border-radius:6px;
  background: rgba(238,228,218,0.15);
  display:flex;
  align-items:center;
  justify-content:center;
  color: transparent;
  user-select:none;
}

/* плитка */
.tile{
  position:absolute;
  top:0;
  left:0;
  width: var(--cell-size);
  height: var(--cell-size);
  line-height: calc(var(--cell-size));
  border-radius:6px;
  font-weight:700;
  font-size: calc(var(--cell-size) * 0.36);
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow: 0 2px 0 rgba(0,0,0,0.08);
  transition: transform var(--transition) ease, background-color 120ms linear, font-size 120ms linear;
  transform-origin:center center;
  z-index:2;
  color: #776e65;
}

/* новый / объединённый эффект */
.tile.new {
  animation: appear 160ms ease;
}
@keyframes appear {
  0% { transform: scale(0.1); opacity:0; }
  60% { transform: scale(1.12); opacity:1; }
  100% { transform: scale(1); }
}
.tile.merged {
  animation: merged 220ms ease;
}
@keyframes merged {
  0% { transform: scale(1); }
  50% { transform: scale(1.18); }
  100% { transform: scale(1); }
}

/* цвета плиток (основные) */
.tile-2 { background:#eee4da; color:#776e65; }
.tile-4 { background:#ede0c8; color:#776e65; }
.tile-8 { background:#f2b179; color:#f9f6f2; }
.tile-16 { background:#f59563; color:#f9f6f2; }
.tile-32 { background:#f67c5f; color:#f9f6f2; }
.tile-64 { background:#f65e3b; color:#f9f6f2; }
.tile-128{ background:#edcf72; color:#f9f6f2; font-size: calc(var(--cell-size) * 0.30); }
.tile-256{ background:#edcc61; color:#f9f6f2; font-size: calc(var(--cell-size) * 0.30); }
.tile-512{ background:#edc850; color:#f9f6f2; font-size: calc(var(--cell-size) * 0.28); }
.tile-1024{ background:#edc53f; color:#f9f6f2; font-size: calc(var(--cell-size) * 0.24); }
.tile-2048{ background:#edc22e; color:#f9f6f2; font-size: calc(var(--cell-size) * 0.22); }

/* модалки */
.modal{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.25);
  z-index:50;
}
.modal.hidden{ display:none; }
.modal-card{
  background: #fbf6ef;
  border-radius:10px;
  padding:16px;
  min-width:260px;
  text-align:center;
  box-shadow:0 10px 20px rgba(0,0,0,0.12);
}
.modal-title{ font-size:18px; margin:6px 0; }
.modal-actions{ margin-top:10px; display:flex; gap:8px; justify-content:center; }

#name-input{ padding:8px; width:80%; border-radius:6px; border:1px solid #ddd; }

/* leaderboard table */
.leaderboard-table{ width:100%; border-collapse:collapse; margin-top:8px; }
.leaderboard-table th, .leaderboard-table td{ padding:6px; border-bottom:1px solid #eee; text-align:center; font-size:14px; }

/* мобильные кнопки: показываем на маленьких экранах и скрываем клавиши в модалках */
.mobile-controls{ display:none; margin-top:10px; }
.mobile-controls .row{ display:flex; justify-content:center; gap:10px; margin:6px 0; }
.mobile-controls .m-btn{
  width:64px; height:64px; border-radius:10px; border:none; background:#8f7a66; color:white; font-size:24px; cursor:pointer;
}

/* адаптив — на маленьких экранах увеличиваем поле по экрану */
@media (max-width: 700px){
  :root{ --board-max-width: 92vw; }
  .title{ font-size:22px; }
  .buttons button{ padding:8px; font-size:14px; }
  .mobile-controls{ display:block; }
  /* сократим отступы между ячейками на узких экранах — JS также подстроит */
  :root{ --board-gap: 8; }
}
